## input data format: htseq-count output
dir.htseq = "C:/Users/10453/source/repos/SGN/nicotiana/subGenomeAssignment/DEseq2/htseq"
files.htseq = grep("htseq",list.files(dir.htseq),value=TRUE)
condition = c("Control_T0","Control_T0","Control_T0",
"Control_T2","Control_T2","Control_T2",
"meJA_T2","meJA_T2","meJA_T2",
"Control_T6","Control_T6","Control_T6",
"meJA_T6","meJA_T6",
"Control_T24","Control_T24","Control_T24",
"meJA_T24","meJA_T24","meJA_T24")
sampleTable <- data.frame(sampleName = files.htseq,
fileName = files.htseq,
condition = condition)
library("DESeq2")
ddsHTSeq <- DESeqDataSetFromHTSeqCount(sampleTable = sampleTable,
directory = dir.htseq,
design= ~ condition)
ddsHTseq
ddsHTSeq
colData(ddsHTSeq)
dds = DESeq(ddsHTSeq)
dds
res = results(dds)
res
resOrdered = res[order(res$padj),]
resOrdered
summary(resOrdered)
sum(res$padj<0.05,na.rm=TRUE)
res[res$padj<0.05,]
res[list(res$padj<0.05,na.rm=True),]
res[list(res$padj<0.05,na.rm=TRUE),]
## First let's compare meJA_T6 against Control_T6
## The reason for such a comparison:
## We observed that T6 has the highest number of biased gene paris; and the number
## of biased genes rises from T0 to T6 and drops from T6 to T24, so T6 might represent
## the climax of the effect of Jasmonate treatment.
ddsHTSeq$condition <- relevel(ddsHTSeq$condition, ref = "Control_T6")
dds = DESeq(ddsHTSeq)
dds
result = results(ddsHTSeq)
result = results(dds)
result
resOrdered = res[order(res$padj),]
res.sig = res[which(resOrdered$padj<0.05),]
genes.sig = res.sig[,1]
genes.sig
res.sig
result = results(dds)
resOrdered = result[order(result$padj),]
res.sig = result[which(resOrdered$padj<0.05),]
genes.sig = res.sig[,1]
res.sig
result = results(dds)
resOrdered = result[order(result$padj),]
# write the results to output
write.csv(as.data.frame(resOrdered), file="Control_T6.vs.meJA_T6.csv")
## Now compare meJA_T2 against Control_T2
ddsHTSeq$condition <- relevel(ddsHTSeq$condition, ref = "Control_T2")
dds = DESeq(ddsHTSeq)
result = results(dds)
result
result = results(dds, contrast=c('condition','meJA_T2','Control_T2'))
result
## Now compare meJA_T2 against Control_T2
ddsHTSeq$condition <- relevel(ddsHTSeq$condition, ref = "Control_T2")
dds = DESeq(ddsHTSeq)
result = results(dds, contrast=c('condition','meJA_T2','Control_T2'))
resOrdered = result[order(result$padj),]
# write the results to output
write.csv(as.data.frame(resOrdered), file="Control_T2.vs.meJA_T2.csv")
##Now compare meJA_T24 against Control_T24
ddsHTSeq$condition <- relevel(ddsHTSeq$condition, ref = "Control_T24")
dds = DESeq(ddsHTSeq)
result = results(dds, contrast=c('condition','meJA_T24','Control_T24'))
resOrdered = result[order(result$padj),]
# write the results to output
write.csv(as.data.frame(resOrdered), file="Control_T24.vs.meJA_T24.csv")
result
result$stat
as.data.frame(result)
as.data.frame(result)[,1]
as.data.frame(result)[,0]
as.data.frame(result)
r = as.data.frame(result)
str(r)
rownames(r)
rownames(r[r$padj<0.05,])
rownames(r[which(r$padj<0.05),])
rownames(result)
fdr = 0.05
## DE analysis using DESeq2
## input data format: htseq-count output
go = function(gList){
### GO enrichment analysis
setwd("C:/Users/10453/source/repos/SGN/nicotiana/subGenomeAssignment/GO")
library(topGO)
geneID2GO <- readMappings(file = "Ntab.gene2go.newAnnot")
# the gene universe is given by the following line
# A total of 34056 genes get one or more GO terms assigned to it
geneNames = names(geneID2GO)
gene.of.interest = geneList(gList)
gene.of.interest = as.integer(geneNames %in% gene.of.interest)
gene.of.interest = factor(gene.of.interest)
names(gene.of.interest) = geneNames # make it intno a named vector
GOdata = new("topGOdata", ontology="BP", allGenes=gene.of.interest,
annot=annFUN.gene2GO, gene2GO=geneID2GO)
test.stat = new("classicCount", testStatistic = GOFisherTest, name = "Fisher test")
resultFisher = getSigGroups(GOdata, test.stat)
pvals = score(resultFisher)
allRes = GenTable(GOdata, classic = resultFisher,
orderBy = "classic", ranksOf = "classic", topNodes = 20)
return (allRes)
}
fdr = 0.05
dir.htseq = "C:/Users/10453/source/repos/SGN/nicotiana/subGenomeAssignment/DEseq2/htseq"
files.htseq = grep("htseq",list.files(dir.htseq),value=TRUE)
condition = c("Control_T0","Control_T0","Control_T0",
"Control_T2","Control_T2","Control_T2",
"meJA_T2","meJA_T2","meJA_T2",
"Control_T6","Control_T6","Control_T6",
"meJA_T6","meJA_T6",
"Control_T24","Control_T24","Control_T24",
"meJA_T24","meJA_T24","meJA_T24")
sampleTable <- data.frame(sampleName = files.htseq,
fileName = files.htseq,
condition = condition)
library("DESeq2")
ddsHTSeq <- DESeqDataSetFromHTSeqCount(sampleTable = sampleTable,
directory = dir.htseq,
design= ~ condition)
## First let's compare meJA_T6 against Control_T6
## The reason for such a comparison:
## We observed that T6 has the highest number of biased gene paris; and the number
## of biased genes rises from T0 to T6 and drops from T6 to T24, so T6 might represent
## the climax of the effect of Jasmonate treatment.
ddsHTSeq$condition <- relevel(ddsHTSeq$condition, ref = "Control_T6")
dds = DESeq(ddsHTSeq)
result = results(dds)
sig.gene.t6.vs.t6 = rownames(result[which(result$padj < fdr),])
go.sig.t6.vs.t6 = go(sig.gene.t6.vs.t6)
go = function(gList){
### GO enrichment analysis
setwd("C:/Users/10453/source/repos/SGN/nicotiana/subGenomeAssignment/GO")
library(topGO)
geneID2GO <- readMappings(file = "Ntab.gene2go.newAnnot")
# the gene universe is given by the following line
# A total of 34056 genes get one or more GO terms assigned to it
geneNames = names(geneID2GO)
gene.of.interest = gList
gene.of.interest = as.integer(geneNames %in% gene.of.interest)
gene.of.interest = factor(gene.of.interest)
names(gene.of.interest) = geneNames # make it intno a named vector
GOdata = new("topGOdata", ontology="BP", allGenes=gene.of.interest,
annot=annFUN.gene2GO, gene2GO=geneID2GO)
test.stat = new("classicCount", testStatistic = GOFisherTest, name = "Fisher test")
resultFisher = getSigGroups(GOdata, test.stat)
pvals = score(resultFisher)
allRes = GenTable(GOdata, classic = resultFisher,
orderBy = "classic", ranksOf = "classic", topNodes = 20)
return (allRes)
}
go.sig.t6.vs.t6 = go(sig.gene.t6.vs.t6)
go.sig.t6.vs.t6
## Now compare meJA_T2 against Control_T2
## This comparison seems to yield most DE genes
ddsHTSeq$condition <- relevel(ddsHTSeq$condition, ref = "Control_T2")
dds = DESeq(ddsHTSeq)
result = results(dds, contrast=c('condition','meJA_T2','Control_T2'))
sig.gene.t2.vs.t2 = rownames(result[which(result$padj < fdr),])
go.sig.t2.vs.t2 = go(sig.gene.t2.vs.t2)
go.sig.t2.vs.t2
##Now compare meJA_T24 against Control_T24
ddsHTSeq$condition <- relevel(ddsHTSeq$condition, ref = "Control_T24")
dds = DESeq(ddsHTSeq)
result = results(dds, contrast=c('condition','meJA_T24','Control_T24'))
sig.gene.t24.vs.t24 = rownames(result[which(result$padj < fdr),])
go.sig.t24.vs.t24 = go(sig.gene.t6.vs.t6)
go.sig.t24.vs.t24
fdr = 0.1
dir.htseq = "C:/Users/10453/source/repos/SGN/nicotiana/subGenomeAssignment/DEseq2/htseq"
files.htseq = grep("htseq",list.files(dir.htseq),value=TRUE)
condition = c("Control_T0","Control_T0","Control_T0",
"Control_T2","Control_T2","Control_T2",
"meJA_T2","meJA_T2","meJA_T2",
"Control_T6","Control_T6","Control_T6",
"meJA_T6","meJA_T6",
"Control_T24","Control_T24","Control_T24",
"meJA_T24","meJA_T24","meJA_T24")
sampleTable <- data.frame(sampleName = files.htseq,
fileName = files.htseq,
condition = condition)
library("DESeq2")
ddsHTSeq <- DESeqDataSetFromHTSeqCount(sampleTable = sampleTable,
directory = dir.htseq,
design= ~ condition)
## First let's compare meJA_T6 against Control_T6
## The reason for such a comparison:
## We observed that T6 has the highest number of biased gene paris; and the number
## of biased genes rises from T0 to T6 and drops from T6 to T24, so T6 might represent
## the climax of the effect of Jasmonate treatment.
ddsHTSeq$condition <- relevel(ddsHTSeq$condition, ref = "Control_T6")
dds = DESeq(ddsHTSeq)
result = results(dds)
sig.gene.t6.vs.t6 = rownames(result[which(result$padj < fdr),])
go.sig.t6.vs.t6 = go(sig.gene.t6.vs.t6)
resOrdered = result[order(result$padj),]
# write the results to output
write.csv(as.data.frame(resOrdered), file="Control_T6.vs.meJA_T6.csv")
## Now compare meJA_T2 against Control_T2
## This comparison seems to yield most DE genes
ddsHTSeq$condition <- relevel(ddsHTSeq$condition, ref = "Control_T2")
dds = DESeq(ddsHTSeq)
result = results(dds, contrast=c('condition','meJA_T2','Control_T2'))
sig.gene.t2.vs.t2 = rownames(result[which(result$padj < fdr),])
go.sig.t2.vs.t2 = go(sig.gene.t2.vs.t2)
resOrdered = result[order(result$padj),]
# write the results to output
write.csv(as.data.frame(resOrdered), file="Control_T2.vs.meJA_T2.csv")
##Now compare meJA_T24 against Control_T24
ddsHTSeq$condition <- relevel(ddsHTSeq$condition, ref = "Control_T24")
dds = DESeq(ddsHTSeq)
result = results(dds, contrast=c('condition','meJA_T24','Control_T24'))
sig.gene.t24.vs.t24 = rownames(result[which(result$padj < fdr),])
go.sig.t24.vs.t24 = go(sig.gene.t6.vs.t6)
resOrdered = result[order(result$padj),]
# write the results to output
write.csv(as.data.frame(resOrdered), file="Control_T24.vs.meJA_T24.csv")
go.sig.t24.vs.t24
go.sig.t6.vs.t6
go.sig.t2.vs.t2
go.sig.t2.vs.t2
go.sig.t6.vs.t6
go.sig.t24.vs.t24
### Read a file that contains a list of genes of interest,
### and return a R list object of these genes of interest
geneList = function(Infile, col){
gene.list = list()
con = file(Infile, "r")
while(TRUE){
line = readLines(con, n=1)
if (length(line) == 0){
break
}
gene.list = c(gene.list, strsplit(trimws(line),"\t")[[1]][col])
}
close(con)
return (gene.list)
}
### GO enrichment analysis
setwd("C:/Users/10453/source/repos/SGN/nicotiana/subGenomeAssignment/GO")
library(topGO)
geneID2GO <- readMappings(file = "Ntab.gene2go.newAnnot")
# the gene universe is given by the following line
# A total of 34056 genes get one or more GO terms assigned to it
geneNames = names(geneID2GO)
gene.of.interest = geneList("HEB.meJA_T24.towards.Ntom.txt", 2)
gene.of.interest = as.integer(geneNames %in% gene.of.interest)
gene.of.interest = factor(gene.of.interest)
names(gene.of.interest) = geneNames # make it intno a named vector
GOdata = new("topGOdata", ontology="BP", allGenes=gene.of.interest,
annot=annFUN.gene2GO, gene2GO=geneID2GO)
test.stat = new("classicCount", testStatistic = GOFisherTest, name = "Fisher test")
resultFisher = getSigGroups(GOdata, test.stat)
pvals = score(resultFisher)
allRes = GenTable(GOdata, classic = resultFisher,
orderBy = "classic", ranksOf = "classic", topNodes = 20)
allRes
### Read a file that contains a list of genes of interest,
### and return a R list object of these genes of interest
geneList = function(Infile, col){
gene.list = list()
con = file(Infile, "r")
while(TRUE){
line = readLines(con, n=1)
if (length(line) == 0){
break
}
gene.list = c(gene.list, strsplit(trimws(line),"\t")[[1]][col])
}
close(con)
return (gene.list)
}
### GO enrichment analysis
setwd("C:/Users/10453/source/repos/SGN/nicotiana/subGenomeAssignment/GO")
library(topGO)
geneID2GO <- readMappings(file = "Ntab.gene2go.newAnnot")
# the gene universe is given by the following line
# A total of 34056 genes get one or more GO terms assigned to it
geneNames = names(geneID2GO)
gene.of.interest = geneList("HEB.meJA_T24.towards.Nsyl.txt", 1)
gene.of.interest = as.integer(geneNames %in% gene.of.interest)
gene.of.interest = factor(gene.of.interest)
names(gene.of.interest) = geneNames # make it intno a named vector
GOdata = new("topGOdata", ontology="BP", allGenes=gene.of.interest,
annot=annFUN.gene2GO, gene2GO=geneID2GO)
test.stat = new("classicCount", testStatistic = GOFisherTest, name = "Fisher test")
resultFisher = getSigGroups(GOdata, test.stat)
pvals = score(resultFisher)
allRes = GenTable(GOdata, classic = resultFisher,
orderBy = "classic", ranksOf = "classic", topNodes = 20)
allRes
### Read a file that contains a list of genes of interest,
### and return a R list object of these genes of interest
geneList = function(Infile, col){
gene.list = list()
con = file(Infile, "r")
while(TRUE){
line = readLines(con, n=1)
if (length(line) == 0){
break
}
gene.list = c(gene.list, strsplit(trimws(line),"\t")[[1]][col])
}
close(con)
return (gene.list)
}
### GO enrichment analysis
setwd("C:/Users/10453/source/repos/SGN/nicotiana/subGenomeAssignment/GO")
library(topGO)
geneID2GO <- readMappings(file = "Ntab.gene2go.newAnnot")
# the gene universe is given by the following line
# A total of 34056 genes get one or more GO terms assigned to it
geneNames = names(geneID2GO)
gene.of.interest = geneList("HEB.meJA_T2.towards.Nsyl.txt", 1)
gene.of.interest = as.integer(geneNames %in% gene.of.interest)
gene.of.interest = factor(gene.of.interest)
names(gene.of.interest) = geneNames # make it intno a named vector
GOdata = new("topGOdata", ontology="BP", allGenes=gene.of.interest,
annot=annFUN.gene2GO, gene2GO=geneID2GO)
test.stat = new("classicCount", testStatistic = GOFisherTest, name = "Fisher test")
resultFisher = getSigGroups(GOdata, test.stat)
pvals = score(resultFisher)
allRes = GenTable(GOdata, classic = resultFisher,
orderBy = "classic", ranksOf = "classic", topNodes = 20)
allRes
### Read a file that contains a list of genes of interest,
### and return a R list object of these genes of interest
geneList = function(Infile, col){
gene.list = list()
con = file(Infile, "r")
while(TRUE){
line = readLines(con, n=1)
if (length(line) == 0){
break
}
gene.list = c(gene.list, strsplit(trimws(line),"\t")[[1]][col])
}
close(con)
return (gene.list)
}
### GO enrichment analysis
setwd("C:/Users/10453/source/repos/subgenomeAssignment/GO")
library(topGO)
geneID2GO <- readMappings(file = "Ntab.gene2go")
# the gene universe is given by the following line
# A total of 34056 genes get one or more GO terms assigned to it
geneNames = names(geneID2GO)
gene.of.interest = geneList("HEB.meJA_T2.towards.Ntom.txt", 2)
gene.of.interest = as.integer(geneNames %in% gene.of.interest)
gene.of.interest = factor(gene.of.interest)
names(gene.of.interest) = geneNames # make it intno a named vector
GOdata = new("topGOdata", ontology="BP", allGenes=gene.of.interest,
annot=annFUN.gene2GO, gene2GO=geneID2GO)
test.stat = new("classicCount", testStatistic = GOFisherTest, name = "Fisher test")
resultFisher = getSigGroups(GOdata, test.stat)
pvals = score(resultFisher)
allRes = GenTable(GOdata, classic = resultFisher,
orderBy = "classic", ranksOf = "classic", topNodes = 20)
### Read a file that contains a list of genes of interest,
### and return a R list object of these genes of interest
geneList = function(Infile, col){
gene.list = list()
con = file(Infile, "r")
while(TRUE){
line = readLines(con, n=1)
if (length(line) == 0){
break
}
gene.list = c(gene.list, strsplit(trimws(line),"\t")[[1]][col])
}
close(con)
return (gene.list)
}
### GO enrichment analysis
setwd("C:/Users/10453/source/repos/SGN/nicotiana/subGenomeAssignment/GO")
library(topGO)
geneID2GO <- readMappings(file = "Ntab.gene2go")
# the gene universe is given by the following line
# A total of 34056 genes get one or more GO terms assigned to it
geneNames = names(geneID2GO)
gene.of.interest = geneList("HEB.meJA_T2.towards.Ntom.txt", 2)
gene.of.interest = as.integer(geneNames %in% gene.of.interest)
gene.of.interest = factor(gene.of.interest)
names(gene.of.interest) = geneNames # make it intno a named vector
GOdata = new("topGOdata", ontology="BP", allGenes=gene.of.interest,
annot=annFUN.gene2GO, gene2GO=geneID2GO)
test.stat = new("classicCount", testStatistic = GOFisherTest, name = "Fisher test")
resultFisher = getSigGroups(GOdata, test.stat)
pvals = score(resultFisher)
allRes = GenTable(GOdata, classic = resultFisher,
orderBy = "classic", ranksOf = "classic", topNodes = 20)
allRes
### Read a file that contains a list of genes of interest,
### and return a R list object of these genes of interest
geneList = function(Infile, col){
gene.list = list()
con = file(Infile, "r")
while(TRUE){
line = readLines(con, n=1)
if (length(line) == 0){
break
}
gene.list = c(gene.list, strsplit(trimws(line),"\t")[[1]][col])
}
close(con)
return (gene.list)
}
### GO enrichment analysis
setwd("C:/Users/10453/source/repos/SGN/nicotiana/subGenomeAssignment/GO")
library(topGO)
geneID2GO <- readMappings(file = "Ntab.gene2go")
# the gene universe is given by the following line
# A total of 34056 genes get one or more GO terms assigned to it
geneNames = names(geneID2GO)
gene.of.interest = geneList("HEB.meJA_T2.towards.Nsyl.txt", 1)
gene.of.interest = as.integer(geneNames %in% gene.of.interest)
gene.of.interest = factor(gene.of.interest)
names(gene.of.interest) = geneNames # make it intno a named vector
GOdata = new("topGOdata", ontology="BP", allGenes=gene.of.interest,
annot=annFUN.gene2GO, gene2GO=geneID2GO)
test.stat = new("classicCount", testStatistic = GOFisherTest, name = "Fisher test")
resultFisher = getSigGroups(GOdata, test.stat)
pvals = score(resultFisher)
allRes = GenTable(GOdata, classic = resultFisher,
orderBy = "classic", ranksOf = "classic", topNodes = 20)
### Read a file that contains a list of genes of interest,
### and return a R list object of these genes of interest
geneList = function(Infile, col){
gene.list = list()
con = file(Infile, "r")
while(TRUE){
line = readLines(con, n=1)
if (length(line) == 0){
break
}
gene.list = c(gene.list, strsplit(trimws(line),"\t")[[1]][col])
}
close(con)
return (gene.list)
}
### GO enrichment analysis
setwd("C:/Users/10453/source/repos/SGN/nicotiana/subGenomeAssignment/GO")
library(topGO)
geneID2GO <- readMappings(file = "Ntab.gene2go.newAnnot")
# the gene universe is given by the following line
# A total of 34056 genes get one or more GO terms assigned to it
geneNames = names(geneID2GO)
gene.of.interest = geneList("HEB.meJA_T2.towards.Nsyl.txt", 1)
gene.of.interest = as.integer(geneNames %in% gene.of.interest)
gene.of.interest = factor(gene.of.interest)
names(gene.of.interest) = geneNames # make it intno a named vector
GOdata = new("topGOdata", ontology="BP", allGenes=gene.of.interest,
annot=annFUN.gene2GO, gene2GO=geneID2GO)
test.stat = new("classicCount", testStatistic = GOFisherTest, name = "Fisher test")
resultFisher = getSigGroups(GOdata, test.stat)
pvals = score(resultFisher)
allRes = GenTable(GOdata, classic = resultFisher,
orderBy = "classic", ranksOf = "classic", topNodes = 20)
allRes
### Read a file that contains a list of genes of interest,
### and return a R list object of these genes of interest
geneList = function(Infile, col){
gene.list = list()
con = file(Infile, "r")
while(TRUE){
line = readLines(con, n=1)
if (length(line) == 0){
break
}
gene.list = c(gene.list, strsplit(trimws(line),"\t")[[1]][col])
}
close(con)
return (gene.list)
}
### GO enrichment analysis
setwd("C:/Users/10453/source/repos/SGN/nicotiana/subGenomeAssignment/GO")
library(topGO)
geneID2GO <- readMappings(file = "Ntab.gene2go.newAnnot")
# the gene universe is given by the following line
# A total of 34056 genes get one or more GO terms assigned to it
geneNames = names(geneID2GO)
gene.of.interest = geneList("HEB.meJA_T2.towards.Ntom.txt", 2)
gene.of.interest = as.integer(geneNames %in% gene.of.interest)
gene.of.interest = factor(gene.of.interest)
names(gene.of.interest) = geneNames # make it intno a named vector
GOdata = new("topGOdata", ontology="BP", allGenes=gene.of.interest,
annot=annFUN.gene2GO, gene2GO=geneID2GO)
test.stat = new("classicCount", testStatistic = GOFisherTest, name = "Fisher test")
resultFisher = getSigGroups(GOdata, test.stat)
pvals = score(resultFisher)
allRes = GenTable(GOdata, classic = resultFisher,
orderBy = "classic", ranksOf = "classic", topNodes = 20)
allRes
result
resultsNames(result)
resultsNames(dds)
resLFC = lfcShrink(dds,coef="condition_meJA_T24_vs_Control_T24",type="apeglm")
BiocManager::install("apeglm")
resLFC = lfcShrink(dds,coef="condition_meJA_T24_vs_Control_T24",type="apeglm")
resLFC
plotMA(resLFC,ylim=c(-3,3))
plotMA(result,ylim=c(-3,3))
